# DNS4M365 v1.1.0 - Migration Assessment Examples

This document contains realistic mocked examples of the new v1.1.0 migration assessment features with 2024-2025 Microsoft 365 DNS updates.

---

## Example 1: Migration Status - Domain Needs Critical Updates

### Command
```powershell
Get-M365DomainMigrationStatus -DomainName "contoso.com" -ShowRecommendations
```

### Output
```
Assessing migration status for: contoso.com

  Overall Readiness: 40%
  Migration Priority: CRITICAL
  MX Format: mail.protection.outlook.com (legacy)
  DKIM Format: Not Configured
  Email Auth Status: Not Ready

  Critical Actions Required:
    - Migrate MX record to mx.microsoft format (Message Center MC1048624, July-August 2025)
    - CRITICAL: No SPF record found - MANDATORY for email authentication (April 2025)
    - CRITICAL: No DMARC record found - MANDATORY with policy p=quarantine or p=reject (April 2025)
    - CRITICAL: Remove msoid.contoso.com CNAME - BLOCKS Microsoft 365 Apps activation

  Recommendations:
    - Configure DKIM signing for improved email authentication
```

### Returned Object
```powershell
Domain                  : contoso.com
OverallReadiness        : 40
MXStatus                : Legacy
MXFormat                : mail.protection.outlook.com (legacy)
MXNeedsMigration        : True
DKIMStatus              : Not Configured
DKIMFormat              : Unknown
DKIMNeedsMigration      : False
EmailAuthStatus         : Not Ready
SPFConfigured           : False
DMARCConfigured         : False
EmailAuthReady          : False
DeprecatedRecords       : {msoid.contoso.com}
LegacyTeamsRecords      : {}
CriticalActions         : {Migrate MX record to mx.microsoft format..., CRITICAL: No SPF record found...,
                          CRITICAL: No DMARC record found..., CRITICAL: Remove msoid.contoso.com CNAME...}
Recommendations         : {Configure DKIM signing for improved email authentication}
MigrationPriority       : CRITICAL
```

---

## Example 2: Migration Status - Domain with Legacy DKIM and MX

### Command
```powershell
Get-M365DomainMigrationStatus -DomainName "fabrikam.com" -ShowRecommendations
```

### Output
```
Assessing migration status for: fabrikam.com

  Overall Readiness: 60%
  Migration Priority: High
  MX Format: mail.protection.outlook.com (legacy)
  DKIM Format: onmicrosoft.com (legacy)
  Email Auth Status: Ready

  Critical Actions Required:
    - Migrate MX record to mx.microsoft format (Message Center MC1048624, July-August 2025)

  Recommendations:
    - DKIM using legacy format - new deployments use dkim.mail.microsoft format (May 2025+)
    - DMARC policy is 'none' - upgrade to 'quarantine' or 'reject' for April 2025 compliance

  Legacy Teams/Skype Records:
    - sip.fabrikam.com CNAME
    - lyncdiscover.fabrikam.com CNAME
    - _sip._tls.fabrikam.com SRV
```

### Returned Object
```powershell
Domain                  : fabrikam.com
OverallReadiness        : 60
MXStatus                : Legacy
MXFormat                : mail.protection.outlook.com (legacy)
MXNeedsMigration        : True
DKIMStatus              : Legacy
DKIMFormat              : onmicrosoft.com (legacy)
DKIMNeedsMigration      : True
EmailAuthStatus         : Ready
SPFConfigured           : True
DMARCConfigured         : True
EmailAuthReady          : True
DeprecatedRecords       : {}
LegacyTeamsRecords      : {sip.fabrikam.com CNAME, lyncdiscover.fabrikam.com CNAME, _sip._tls.fabrikam.com SRV}
CriticalActions         : {Migrate MX record to mx.microsoft format...}
Recommendations         : {DKIM using legacy format..., DMARC policy is 'none'...}
MigrationPriority       : High
```

---

## Example 3: Migration Status - Modern Domain (Fully Ready)

### Command
```powershell
Get-M365DomainMigrationStatus -DomainName "moderncompany.com" -ShowRecommendations
```

### Output
```
Assessing migration status for: moderncompany.com

  Overall Readiness: 100%
  Migration Priority: Low
  MX Format: mx.microsoft (current)
  DKIM Format: dkim.mail.microsoft (current)
  Email Auth Status: Ready
```

### Returned Object
```powershell
Domain                  : moderncompany.com
OverallReadiness        : 100
MXStatus                : Modern
MXFormat                : mx.microsoft (current)
MXNeedsMigration        : False
DKIMStatus              : Modern
DKIMFormat              : dkim.mail.microsoft (current)
DKIMNeedsMigration      : False
EmailAuthStatus         : Ready
SPFConfigured           : True
DMARCConfigured         : True
EmailAuthReady          : True
DeprecatedRecords       : {}
LegacyTeamsRecords      : {}
CriticalActions         : {}
Recommendations         : {}
MigrationPriority       : Low
```

---

## Example 4: Migration Status - All Domains with Export

### Command
```powershell
Get-M365DomainMigrationStatus -ExportReport -OutputPath "C:\Reports"
```

### Output
```
Assessing migration status for: contoso.com

  Overall Readiness: 40%
  Migration Priority: CRITICAL
  MX Format: mail.protection.outlook.com (legacy)
  DKIM Format: Not Configured
  Email Auth Status: Not Ready

  Critical Actions Required:
    - Migrate MX record to mx.microsoft format (Message Center MC1048624, July-August 2025)
    - CRITICAL: No SPF record found - MANDATORY for email authentication (April 2025)
    - CRITICAL: No DMARC record found - MANDATORY with policy p=quarantine or p=reject (April 2025)
    - CRITICAL: Remove msoid.contoso.com CNAME - BLOCKS Microsoft 365 Apps activation

Assessing migration status for: fabrikam.com

  Overall Readiness: 60%
  Migration Priority: High
  MX Format: mail.protection.outlook.com (legacy)
  DKIM Format: onmicrosoft.com (legacy)
  Email Auth Status: Ready

  Critical Actions Required:
    - Migrate MX record to mx.microsoft format (Message Center MC1048624, July-August 2025)

  Recommendations:
    - DKIM using legacy format - new deployments use dkim.mail.microsoft format (May 2025+)
    - DMARC policy is 'none' - upgrade to 'quarantine' or 'reject' for April 2025 compliance

Assessing migration status for: moderncompany.com

  Overall Readiness: 100%
  Migration Priority: Low
  MX Format: mx.microsoft (current)
  DKIM Format: dkim.mail.microsoft (current)
  Email Auth Status: Ready

Assessing migration status for: adventureworks.com

  Overall Readiness: 80%
  Migration Priority: Medium
  MX Format: mx.microsoft (current)
  DKIM Format: onmicrosoft.com (legacy)
  Email Auth Status: Ready

  Recommendations:
    - DKIM using legacy format - new deployments use dkim.mail.microsoft format (May 2025+)

Migration report exported to: C:\Reports\M365-Migration-Status-20250106-143022.csv

=== Migration Status Summary ===
Total Domains Assessed: 4
Average Readiness: 70%
CRITICAL Priority: 1
High Priority: 1
```

### CSV Export Sample
```csv
Domain,OverallReadiness,MigrationPriority,MXStatus,MXFormat,DKIMStatus,DKIMFormat,EmailAuthStatus,SPFConfigured,DMARCConfigured,CriticalActionsCount,DeprecatedRecordsCount,LegacyRecordsCount
contoso.com,40,CRITICAL,Legacy,mail.protection.outlook.com (legacy),Not Configured,Unknown,Not Ready,False,False,4,1,0
fabrikam.com,60,High,Legacy,mail.protection.outlook.com (legacy),Legacy,onmicrosoft.com (legacy),Ready,True,True,1,0,3
moderncompany.com,100,Low,Modern,mx.microsoft (current),Modern,dkim.mail.microsoft (current),Ready,True,True,0,0,0
adventureworks.com,80,Medium,Modern,mx.microsoft (current),Legacy,onmicrosoft.com (legacy),Ready,True,True,0,0,0
```

---

## Example 5: Enhanced DNS Health Check - Legacy Configuration

### Command
```powershell
Get-M365DomainDNSHealth -DomainName "contoso.com" -IncludeSPF -IncludeDMARC -CheckDKIMResolution -CheckDeprecated -CheckSRVRecords
```

### Output
```
Checking DNS health for: contoso.com

  Overall Health: Critical
  Issues: 4 | Warnings: 2 | Recommendations: 3

  Critical Issues:
    - DEPRECATED: msoid CNAME found - MUST BE REMOVED (blocks M365 Apps activation)
    - No SPF record found - REQUIRED for email delivery
    - CRITICAL: Email authentication mandatory starting April 2025 - SPF record MUST exist
    - No DMARC record found - REQUIRED for email security
    - CRITICAL: Email authentication mandatory starting April 2025 - DMARC record MUST exist with policy p=quarantine or p=reject

  Warnings:
    - DKIM selectors not configured - email authentication will be limited
    - No SIP Federation SRV record found - Teams external access/federation requires this record

  Recommendations:
    - Consider migrating to new mx.microsoft format (Microsoft Message Center MC1048624, July-August 2025 timeline)
    - Configure DKIM signing in Exchange Online admin center for this domain
    - NOTE: _sip._tls SRV record is legacy - Teams-only tenants only need _sipfederationtls._tcp (2024 update)
```

### Returned Object (Partial)
```powershell
Domain                  : contoso.com
OverallHealth          : Critical
MXRecord               : @{Exists=True; Target=contoso-com.mail.protection.outlook.com; Priority=0;
                         IsMicrosoft365=True; Format=Legacy (mail.protection.outlook.com)}
AutodiscoverCNAME      : @{Exists=True; Target=autodiscover.outlook.com; IsCorrect=True}
SPFRecord              : @{Exists=False}
DMARCRecord            : @{Exists=False}
DKIMSelector1          : @{Exists=False; Target=; PointsToMicrosoft=False; Format=Unknown}
DKIMSelector2          : @{Exists=False; Target=; PointsToMicrosoft=False; Format=Unknown}
SIPTLSSRVRecord        : @{Exists=False}
SIPFederationSRVRecord : @{Exists=False}
EnterpriseEnrollment   : @{Exists=True; Target=enterpriseenrollment.manage.microsoft.com; IsCorrect=True}
EnterpriseRegistration : @{Exists=True; Target=enterpriseregistration.windows.net; IsCorrect=True}
DeprecatedMSOID        : @{Exists=True; Target=clientconfig.microsoftonline-p.net}
Issues                 : {DEPRECATED: msoid CNAME found - MUST BE REMOVED..., No SPF record found...,
                         CRITICAL: Email authentication mandatory..., No DMARC record found...,
                         CRITICAL: Email authentication mandatory...}
Warnings               : {DKIM selectors not configured..., No SIP Federation SRV record found...}
Recommendations        : {Consider migrating to new mx.microsoft format..., Configure DKIM signing...,
                         NOTE: _sip._tls SRV record is legacy...}
```

---

## Example 6: Enhanced DNS Health Check - Modern Configuration

### Command
```powershell
Get-M365DomainDNSHealth -DomainName "moderncompany.com" -IncludeSPF -IncludeDMARC -CheckDKIMResolution -CheckDeprecated -CheckSRVRecords
```

### Output
```
Checking DNS health for: moderncompany.com

  Overall Health: Healthy
  Issues: 0 | Warnings: 0 | Recommendations: 0

=== DNS Health Check Complete ===
```

### Returned Object (Partial)
```powershell
Domain                  : moderncompany.com
OverallHealth          : Healthy
MXRecord               : @{Exists=True; Target=moderncompany-com.mx.microsoft; Priority=0;
                         IsMicrosoft365=True; Format=Modern (mx.microsoft)}
AutodiscoverCNAME      : @{Exists=True; Target=autodiscover.outlook.com; IsCorrect=True}
SPFRecord              : @{Exists=True; Value=v=spf1 include:spf.protection.outlook.com -all;
                         IncludesMicrosoft365=True; HasHardFail=True; HasSoftFail=False; LookupCount=1}
DMARCRecord            : @{Exists=True; Value=v=DMARC1; p=quarantine; rua=mailto:dmarc@moderncompany.com;
                         Policy=quarantine; SubdomainPolicy=inherited; HasReporting=True; HasForensics=False}
DKIMSelector1          : @{Exists=True; Target=selector1-moderncompany-com._domainkey.moderncompany.dkim.mail.microsoft;
                         PointsToMicrosoft=True; Format=Modern (dkim.mail.microsoft)}
DKIMSelector2          : @{Exists=True; Target=selector2-moderncompany-com._domainkey.moderncompany.dkim.mail.microsoft;
                         PointsToMicrosoft=True; Format=Modern (dkim.mail.microsoft)}
SIPTLSSRVRecord        : @{Exists=False}
SIPFederationSRVRecord : @{Exists=True; Target=sipfed.online.lync.com; Port=5061; IsCorrect=True}
EnterpriseEnrollment   : @{Exists=True; Target=enterpriseenrollment.manage.microsoft.com; IsCorrect=True}
EnterpriseRegistration : @{Exists=True; Target=enterpriseregistration.windows.net; IsCorrect=True}
DeprecatedMSOID        : @{Exists=False}
Issues                 : {}
Warnings               : {}
Recommendations        : {}
```

---

## Example 7: Enhanced DNS Health Check - Legacy with DKIM

### Command
```powershell
Get-M365DomainDNSHealth -DomainName "fabrikam.com" -IncludeSPF -IncludeDMARC -CheckDKIMResolution -CheckDeprecated -CheckSRVRecords
```

### Output
```
Checking DNS health for: fabrikam.com

  Overall Health: Warning
  Issues: 0 | Warnings: 0 | Recommendations: 4

  Recommendations:
    - Consider migrating to new mx.microsoft format (Microsoft Message Center MC1048624, July-August 2025 timeline)
    - DKIM using legacy format - new deployments use dkim.mail.microsoft format (May 2025+)
    - DMARC policy is 'none' - consider upgrading to 'quarantine' or 'reject' for better protection
    - NOTE: _sip._tls SRV record is legacy - Teams-only tenants only need _sipfederationtls._tcp (2024 update)
    - NOTE: sip.fabrikam.com CNAME is legacy (Skype for Business) - not required for Teams-only tenants
    - NOTE: lyncdiscover.fabrikam.com CNAME is legacy (Skype for Business mobile) - not required for Teams-only tenants
```

### Returned Object (Partial)
```powershell
Domain                  : fabrikam.com
OverallHealth          : Warning
MXRecord               : @{Exists=True; Target=fabrikam-com.mail.protection.outlook.com; Priority=0;
                         IsMicrosoft365=True; Format=Legacy (mail.protection.outlook.com)}
SPFRecord              : @{Exists=True; Value=v=spf1 include:spf.protection.outlook.com ~all;
                         IncludesMicrosoft365=True; HasHardFail=False; HasSoftFail=True; LookupCount=1}
DMARCRecord            : @{Exists=True; Value=v=DMARC1; p=none; rua=mailto:dmarc@fabrikam.com;
                         Policy=none; SubdomainPolicy=inherited; HasReporting=True; HasForensics=False}
DKIMSelector1          : @{Exists=True; Target=selector1-fabrikam-com._domainkey.fabrikam.onmicrosoft.com;
                         PointsToMicrosoft=True; Format=Legacy (onmicrosoft.com)}
DKIMSelector2          : @{Exists=True; Target=selector2-fabrikam-com._domainkey.fabrikam.onmicrosoft.com;
                         PointsToMicrosoft=True; Format=Legacy (onmicrosoft.com)}
SIPRecord              : @{Exists=True; Target=sipdir.online.lync.com; IsCorrect=True}
LyncdiscoverRecord     : @{Exists=True; Target=webdir.online.lync.com; IsCorrect=True}
SIPTLSSRVRecord        : @{Exists=True; Target=sipdir.online.lync.com; Port=443; IsCorrect=True}
SIPFederationSRVRecord : @{Exists=True; Target=sipfed.online.lync.com; Port=5061; IsCorrect=True}
DeprecatedMSOID        : @{Exists=False}
Recommendations        : {Consider migrating to new mx.microsoft format..., DKIM using legacy format...,
                         DMARC policy is 'none'..., NOTE: _sip._tls SRV record is legacy...,
                         NOTE: sip.fabrikam.com CNAME is legacy..., NOTE: lyncdiscover.fabrikam.com CNAME is legacy...}
```

---

## Example 8: Enhanced Compare - Legacy MX and DKIM Detection

### Command
```powershell
Compare-M365DomainDNS -DomainName "fabrikam.com" -IncludeOptional
```

### Output (Filtered for interesting records)
```powershell
Domain      : fabrikam.com
RecordType  : MX
Label       : @
FQDN        : fabrikam.com
ExpectedValue : 0 fabrikam-com.mail.protection.outlook.com
ActualValue : 0 fabrikam-com.mail.protection.outlook.com
Status      : Match
SupportedService : Email
IsOptional  : False
TTL         : 3600
Details     : Expected: fabrikam-com.mail.protection.outlook.com, Got: fabrikam-com.mail.protection.outlook.com |
              NOTE: Legacy MX format detected (consider migrating to mx.microsoft)

Domain      : fabrikam.com
RecordType  : CNAME
Label       : selector1._domainkey
FQDN        : selector1._domainkey.fabrikam.com
ExpectedValue : selector1-fabrikam-com._domainkey.fabrikam.onmicrosoft.com
ActualValue : selector1-fabrikam-com._domainkey.fabrikam.onmicrosoft.com
Status      : Match
SupportedService : Email
IsOptional  : False
TTL         : 3600
Details     : Expected: selector1-fabrikam-com._domainkey.fabrikam.onmicrosoft.com,
              Got: selector1-fabrikam-com._domainkey.fabrikam.onmicrosoft.com |
              NOTE: Legacy DKIM format (new deployments use dkim.mail.microsoft)

Domain      : fabrikam.com
RecordType  : CNAME
Label       : sip
FQDN        : sip.fabrikam.com
ExpectedValue : sipdir.online.lync.com
ActualValue : sipdir.online.lync.com
Status      : Match
SupportedService : Teams
IsOptional  : False
TTL         : 3600
Details     : Expected: sipdir.online.lync.com, Got: sipdir.online.lync.com |
              NOTE: Legacy Skype for Business record (not required for Teams-only tenants)

Domain      : fabrikam.com
RecordType  : TXT
Label       : _dmarc
FQDN        : _dmarc.fabrikam.com
ExpectedValue : v=DMARC1; p=quarantine or p=reject (MANDATORY April 2025)
ActualValue : v=DMARC1; p=none; rua=mailto:dmarc@fabrikam.com
Status      : Present
SupportedService : Email Security
IsOptional  : False
TTL         : 3600
Details     :
```

---

## Example 9: Filtering Critical Domains for Migration Planning

### Command
```powershell
# Get migration status for all domains
$migrationStatus = Get-M365DomainMigrationStatus

# Filter domains that need CRITICAL attention
$criticalDomains = $migrationStatus | Where-Object { $_.MigrationPriority -eq "CRITICAL" }

# Display critical domains with action counts
$criticalDomains | Select-Object Domain, OverallReadiness, MigrationPriority,
    @{N='CriticalActions';E={$_.CriticalActions.Count}},
    EmailAuthReady,
    @{N='DeprecatedRecords';E={$_.DeprecatedRecords.Count}} |
Format-Table -AutoSize

# Show detailed actions for each critical domain
foreach ($domain in $criticalDomains) {
    Write-Host "`n=== $($domain.Domain) - Action Plan ===" -ForegroundColor Red
    Write-Host "Readiness: $($domain.OverallReadiness)%" -ForegroundColor Yellow
    Write-Host "`nCritical Actions:"
    $domain.CriticalActions | ForEach-Object { Write-Host "  - $_" -ForegroundColor Red }

    if ($domain.DeprecatedRecords.Count -gt 0) {
        Write-Host "`nDEPRECATED RECORDS TO REMOVE:"
        $domain.DeprecatedRecords | ForEach-Object { Write-Host "  - $_" -ForegroundColor Magenta }
    }
}
```

### Output
```
Domain          OverallReadiness MigrationPriority CriticalActions EmailAuthReady DeprecatedRecords
------          ---------------- ----------------- --------------- -------------- -----------------
contoso.com                   40 CRITICAL                        4 False                          1
legacycorp.com                20 CRITICAL                        5 False                          2

=== contoso.com - Action Plan ===
Readiness: 40%

Critical Actions:
  - Migrate MX record to mx.microsoft format (Message Center MC1048624, July-August 2025)
  - CRITICAL: No SPF record found - MANDATORY for email authentication (April 2025)
  - CRITICAL: No DMARC record found - MANDATORY with policy p=quarantine or p=reject (April 2025)
  - CRITICAL: Remove msoid.contoso.com CNAME - BLOCKS Microsoft 365 Apps activation

DEPRECATED RECORDS TO REMOVE:
  - msoid.contoso.com

=== legacycorp.com - Action Plan ===
Readiness: 20%

Critical Actions:
  - Migrate MX record to mx.microsoft format (Message Center MC1048624, July-August 2025)
  - CRITICAL: No SPF record found - MANDATORY for email authentication (April 2025)
  - CRITICAL: No DMARC record found - MANDATORY with policy p=quarantine or p=reject (April 2025)
  - CRITICAL: Remove msoid.legacycorp.com CNAME - BLOCKS Microsoft 365 Apps activation
  - SPF record does not include Microsoft 365 - MANDATORY for April 2025

DEPRECATED RECORDS TO REMOVE:
  - msoid.legacycorp.com
  - enterpriseregistration.legacycorp.com
```

---

## Example 10: Migration Readiness Dashboard

### Command
```powershell
# Get all migration status
$allStatus = Get-M365DomainMigrationStatus

# Calculate statistics
$stats = @{
    TotalDomains = $allStatus.Count
    AvgReadiness = [math]::Round(($allStatus | Measure-Object -Property OverallReadiness -Average).Average, 0)
    CriticalCount = ($allStatus | Where-Object { $_.MigrationPriority -eq "CRITICAL" }).Count
    HighCount = ($allStatus | Where-Object { $_.MigrationPriority -eq "High" }).Count
    MediumCount = ($allStatus | Where-Object { $_.MigrationPriority -eq "Medium" }).Count
    LowCount = ($allStatus | Where-Object { $_.MigrationPriority -eq "Low" }).Count
    LegacyMX = ($allStatus | Where-Object { $_.MXNeedsMigration -eq $true }).Count
    LegacyDKIM = ($allStatus | Where-Object { $_.DKIMNeedsMigration -eq $true }).Count
    NoEmailAuth = ($allStatus | Where-Object { $_.EmailAuthReady -eq $false }).Count
    WithDeprecated = ($allStatus | Where-Object { $_.DeprecatedRecords.Count -gt 0 }).Count
}

# Display dashboard
Write-Host "`n╔════════════════════════════════════════════════════════╗" -ForegroundColor Cyan
Write-Host "║  Microsoft 365 DNS Migration Readiness Dashboard      ║" -ForegroundColor Cyan
Write-Host "╚════════════════════════════════════════════════════════╝" -ForegroundColor Cyan

Write-Host "`nOverall Statistics:" -ForegroundColor White
Write-Host "  Total Domains: $($stats.TotalDomains)" -ForegroundColor White
Write-Host "  Average Readiness: $($stats.AvgReadiness)%" -ForegroundColor $(
    if ($stats.AvgReadiness -ge 80) { "Green" }
    elseif ($stats.AvgReadiness -ge 60) { "Yellow" }
    else { "Red" }
)

Write-Host "`nMigration Priority:" -ForegroundColor White
Write-Host "  CRITICAL: $($stats.CriticalCount)" -ForegroundColor Red
Write-Host "  High: $($stats.HighCount)" -ForegroundColor Magenta
Write-Host "  Medium: $($stats.MediumCount)" -ForegroundColor Yellow
Write-Host "  Low: $($stats.LowCount)" -ForegroundColor Green

Write-Host "`nConfiguration Issues:" -ForegroundColor White
Write-Host "  Legacy MX Format: $($stats.LegacyMX)" -ForegroundColor Yellow
Write-Host "  Legacy DKIM Format: $($stats.LegacyDKIM)" -ForegroundColor Yellow
Write-Host "  Missing Email Auth: $($stats.NoEmailAuth)" -ForegroundColor Red
Write-Host "  Deprecated Records: $($stats.WithDeprecated)" -ForegroundColor Red

Write-Host "`nTop Priority Actions:" -ForegroundColor White
$actionCounts = @{}
$allStatus | ForEach-Object {
    $_.CriticalActions | ForEach-Object {
        $key = $_ -replace 'contoso|fabrikam|legacycorp', '[DOMAIN]'
        if ($actionCounts.ContainsKey($key)) {
            $actionCounts[$key]++
        } else {
            $actionCounts[$key] = 1
        }
    }
}
$actionCounts.GetEnumerator() | Sort-Object -Property Value -Descending | Select-Object -First 5 | ForEach-Object {
    Write-Host "  [$($_.Value) domains] $($_.Key)" -ForegroundColor Red
}
```

### Output
```
╔════════════════════════════════════════════════════════╗
║  Microsoft 365 DNS Migration Readiness Dashboard      ║
╚════════════════════════════════════════════════════════╝

Overall Statistics:
  Total Domains: 12
  Average Readiness: 68%

Migration Priority:
  CRITICAL: 3
  High: 4
  Medium: 3
  Low: 2

Configuration Issues:
  Legacy MX Format: 7
  Legacy DKIM Format: 5
  Missing Email Auth: 3
  Deprecated Records: 2

Top Priority Actions:
  [7 domains] Migrate MX record to mx.microsoft format (Message Center MC1048624, July-August 2025)
  [3 domains] CRITICAL: No SPF record found - MANDATORY for email authentication (April 2025)
  [3 domains] CRITICAL: No DMARC record found - MANDATORY with policy p=quarantine or p=reject (April 2025)
  [2 domains] CRITICAL: Remove msoid.[DOMAIN].com CNAME - BLOCKS Microsoft 365 Apps activation
  [5 domains] DKIM using legacy format - new deployments use dkim.mail.microsoft format (May 2025+)
```

---

## Example 11: Government Cloud Domain (GCC High)

### Command
```powershell
Get-M365DomainMigrationStatus -DomainName "agency.gov" -ShowRecommendations
```

### Output
```
Assessing migration status for: agency.gov

  Overall Readiness: 80%
  Migration Priority: Medium
  MX Format: office365.us (GCC/DoD)
  DKIM Format: onmicrosoft.com (legacy)
  Email Auth Status: Ready

  Recommendations:
    - DKIM using legacy format - new deployments use dkim.mail.microsoft format (May 2025+)
```

### Returned Object
```powershell
Domain                  : agency.gov
OverallReadiness        : 80
MXStatus                : Government Cloud
MXFormat                : office365.us (GCC/DoD)
MXNeedsMigration        : False
DKIMStatus              : Legacy
DKIMFormat              : onmicrosoft.com (legacy)
DKIMNeedsMigration      : True
EmailAuthStatus         : Ready
SPFConfigured           : True
DMARCConfigured         : True
EmailAuthReady          : True
DeprecatedRecords       : {}
LegacyTeamsRecords      : {}
CriticalActions         : {}
Recommendations         : {DKIM using legacy format...}
MigrationPriority       : Medium
```

---

## Summary

These examples demonstrate:

1. **Migration Assessment**: Identifying domains that need urgent attention for 2025 compliance
2. **Format Detection**: Distinguishing between legacy and modern MX/DKIM formats
3. **Email Authentication**: Critical warnings for April 2025 SPF/DMARC mandates
4. **Deprecated Records**: Identifying msoid and legacy Skype for Business records
5. **Regional Clouds**: Proper handling of GCC High, DoD, and 21Vianet configurations
6. **Actionable Insights**: Prioritized recommendations based on migration timeline
7. **Reporting**: CSV exports for management and tracking

All examples show realistic scenarios administrators will encounter when upgrading to Microsoft 365's 2024-2025 DNS requirements.
